<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cek Microseleb Instagram</title>
    <style>
      :root {
        --primary: #833ab4;
        --gradient-start: #405de6;
        --gradient-mid: #c13584;
        --gradient-end: #e1306c;
        --light: #f8f9fa;
        --dark: #343a40;
        --shadow: rgba(0, 0, 0, 0.1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        background-color: #1e1e2f;
        color: var(--dark);
        line-height: 1.6;
        padding: 20px;
      }

      .container {
        max-width: 600px;
        margin: 0 auto;
        background-color: #27293d;
        border-radius: 10px;
        padding: 30px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
      }

      .logo {
        font-size: 24px;
        font-weight: bold;
        background: linear-gradient(45deg, var(--gradient-start), var(--gradient-mid), var(--gradient-end));
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 10px;
      }

      h2 {
        color: white;
        font-size: 22px;
        font-weight: 600;
      }

      .file-input-group {
        margin-bottom: 20px;
        position: relative;
      }

      .file-input-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #e4e4e4;
      }

      .helper-text {
        color: #adb5bd;
        transition: all 0.3s ease;
      }

      .file-input {
        display: block;
        width: 100%;
        padding: 10px;
        border: 1px solid #dbdbdb;
        border-radius: 5px;
        background-color: #fafafa;
        font-size: 14px;
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .file-input:hover {
        border-color: #a7a7a7;
        box-shadow: 0 0 0 3px rgba(129, 58, 180, 0.1);
      }

      .file-input-wrapper {
        position: relative;
        overflow: hidden;
        display: inline-block;
        width: 100%;
      }

      .file-input-custom {
        position: absolute;
        top: 0;
        right: 0;
        margin: 0;
        padding: 0;
        font-size: 20px;
        cursor: pointer;
        opacity: 0;
        filter: alpha(opacity=0);
      }

      .file-input-button {
        display: block;
        width: 100%;
        padding: 10px;
        border: 2px dashed #42435c;
        border-radius: 5px;
        background-color: #323649;
        color: #e4e4e4;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .file-input-button:hover {
        border-color: var(--primary);
        background-color: #3a3d5a;
      }

      .file-input-button.file-selected {
        border-style: solid;
        border-color: var(--primary);
        background: linear-gradient(45deg, #323649, #3a3d5a);
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(131, 58, 180, 0.4);
        }
        70% {
          box-shadow: 0 0 0 10px rgba(131, 58, 180, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(131, 58, 180, 0);
        }
      }

      .file-name {
        font-weight: bold;
        color: var(--primary);
      }

      .file-status {
        display: block;
        margin-top: 5px;
        font-size: 12px;
        color: #adb5bd;
        transition: all 0.3s ease;
      }

      .file-status.file-selected {
        color: #64d86b;
      }

      .cek-button {
        display: block;
        width: 100%;
        padding: 12px;
        background: linear-gradient(45deg, var(--gradient-start), var(--gradient-mid), var(--gradient-end));
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .cek-button:hover {
        opacity: 0.9;
        transform: translateY(-2px);
        box-shadow: 0 7px 14px rgba(0, 0, 0, 0.25);
      }

      .cek-button:active {
        transform: translateY(1px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
      }

      .cek-button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .cek-button:after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 5px;
        height: 5px;
        background: rgba(255, 255, 255, 0.5);
        opacity: 0;
        border-radius: 100%;
        transform: scale(1, 1) translate(-50%);
        transform-origin: 50% 50%;
      }

      .cek-button:not(:disabled):focus:not(:active)::after {
        animation: ripple 1s ease-out;
      }

      @keyframes ripple {
        0% {
          transform: scale(0, 0);
          opacity: 0.5;
        }
        20% {
          transform: scale(25, 25);
          opacity: 0.5;
        }
        100% {
          opacity: 0;
          transform: scale(40, 40);
        }
      }

      .result-container {
        margin-top: 30px;
        display: none;
        animation: fadeIn 0.5s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .result-title {
        font-weight: 600;
        margin-bottom: 10px;
        font-size: 18px;
        color: #e4e4e4;
      }

      .result-list {
        max-height: 300px;
        overflow-y: auto;
        background-color: #323649;
        border: 1px solid #42435c;
        border-radius: 5px;
        padding: 15px;
        color: #e4e4e4;
      }

      .username {
        padding: 8px 10px;
        border-bottom: 1px solid #42435c;
        animation: slideIn 0.3s ease-out;
        animation-fill-mode: both;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .username:last-child {
        border-bottom: none;
      }

      .loader {
        display: none;
        text-align: center;
        margin: 20px 0;
      }

      .loader p {
        color: #e4e4e4;
        margin-top: 10px;
      }

      .loader-spinner {
        width: 30px;
        height: 30px;
        border: 3px solid #f3f3f3;
        border-top: 3px solid var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .count-info {
        margin-top: 10px;
        text-align: center;
        font-size: 14px;
        color: #adb5bd;
      }

      /* Custom scrollbar */
      .result-list::-webkit-scrollbar {
        width: 8px;
      }

      .result-list::-webkit-scrollbar-track {
        background: #323649;
        border-radius: 5px;
      }

      .result-list::-webkit-scrollbar-thumb {
        background: #42435c;
        border-radius: 5px;
      }

      .result-list::-webkit-scrollbar-thumb:hover {
        background: var(--primary);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="logo">Instagram Check Micro Seleb</div>
        <h2>Cek Siapa yang Micro Seleb</h2>
      </div>

      <div class="file-input-group">
        <label class="file-input-label">File Following:</label>
        <div class="file-input-wrapper">
          <div id="followingButton" class="file-input-button">
            <span id="followingButtonText">Pilih file following.json</span>
            <input type="file" id="followingFile" accept=".json" class="file-input-custom" />
          </div>
          <span id="followingStatus" class="file-status">Belum dipilih</span>
        </div>
      </div>

      <div class="file-input-group">
        <label class="file-input-label">File Followers:</label>
        <div class="file-input-wrapper">
          <div id="followersButton" class="file-input-button">
            <span id="followersButtonText">Pilih file followers_1.json</span>
            <input type="file" id="followersFile" accept=".json" class="file-input-custom" />
          </div>
          <span id="followersStatus" class="file-status">Belum dipilih</span>
        </div>
      </div>

      <button id="cekButton" class="cek-button" disabled>Cek!</button>

      <div class="loader" id="loader">
        <div class="loader-spinner"></div>
        <p>Sedang menganalisis data...</p>
      </div>

      <div class="result-container" id="resultContainer">
        <div class="result-title">Orang yang tidak mengikuti kamu balik:</div>
        <div class="count-info" id="countInfo"></div>
        <div class="result-list" id="resultList"></div>
      </div>
    </div>

    <div style="text-align: center; color: #adb5bd; margin-top: 30px; font-size: 13px">
      <p>
        Made with ❤️ by
        <a href="https://github.com/3ncynida" target="_blank" style="color: #ccc; text-decoration: none">
          <img src="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/github.svg" alt="GitHub" style="width: 14px; vertical-align: middle; margin-right: 4px; filter: invert(90%)" />
          @3ncynida
        </a>
        • MIT License (2025)<br />
        100% free!!! | Enjoy responsibly~ (＾▽＾)
      </p>
    </div>

    <script>
      // Main JavaScript untuk aplikasi
      document.addEventListener("DOMContentLoaded", function () {
        const followingFileInput = document.getElementById("followingFile");
        const followersFileInput = document.getElementById("followersFile");
        const followingButton = document.getElementById("followingButton");
        const followersButton = document.getElementById("followersButton");
        const followingButtonText = document.getElementById("followingButtonText");
        const followersButtonText = document.getElementById("followersButtonText");
        const followingStatus = document.getElementById("followingStatus");
        const followersStatus = document.getElementById("followersStatus");
        const cekButton = document.getElementById("cekButton");
        const loader = document.getElementById("loader");
        const resultContainer = document.getElementById("resultContainer");
        const resultList = document.getElementById("resultList");
        const countInfo = document.getElementById("countInfo");

        // Klik pada button untuk memicu input file
        followingButton.addEventListener("click", function () {
          followingFileInput.click();
        });

        followersButton.addEventListener("click", function () {
          followersFileInput.click();
        });

        // Fungsi untuk mengaktifkan/menonaktifkan tombol dan update UI
        function updateButtonState() {
          const followingSelected = followingFileInput.files.length > 0;
          const followersSelected = followersFileInput.files.length > 0;

          // Update status dan tampilan untuk following file
          if (followingSelected) {
            const fileName = followingFileInput.files[0].name;
            followingButtonText.textContent = fileName;
            followingStatus.textContent = "File dipilih ✓";
            followingStatus.className = "file-status file-selected";
            followingButton.className = "file-input-button file-selected";
          } else {
            followingButtonText.textContent = "Pilih file following.json";
            followingStatus.textContent = "Belum dipilih";
            followingStatus.className = "file-status";
            followingButton.className = "file-input-button";
          }

          // Update status dan tampilan untuk followers file
          if (followersSelected) {
            const fileName = followersFileInput.files[0].name;
            followersButtonText.textContent = fileName;
            followersStatus.textContent = "File dipilih ✓";
            followersStatus.className = "file-status file-selected";
            followersButton.className = "file-input-button file-selected";
          } else {
            followersButtonText.textContent = "Pilih file followers_1.json";
            followersStatus.textContent = "Belum dipilih";
            followersStatus.className = "file-status";
            followersButton.className = "file-input-button";
          }

          // Aktifkan/nonaktifkan tombol cek
          cekButton.disabled = !(followingSelected && followersSelected);

          // Tambahkan efek animasi ke tombol jika aktif
          if (!cekButton.disabled) {
            cekButton.classList.add("ready");
          } else {
            cekButton.classList.remove("ready");
          }
        }

        // Pasang event listener untuk input file
        followingFileInput.addEventListener("change", updateButtonState);
        followersFileInput.addEventListener("change", updateButtonState);

        // Pasang event listener untuk tombol cek
        cekButton.addEventListener("click", checkFollowers);

        // Fungsi utama untuk memeriksa follower
        function checkFollowers() {
          // Tampilkan loader
          loader.style.display = "block";
          resultContainer.style.display = "none";

          // Baca file following
          readFileAsJson(followingFileInput.files[0])
            .then((followingData) => {
              // Ekstrak username dari data following
              const followingRaw = Array.isArray(followingData) ? followingData : followingData.relationships_following || [];
              const following = followingRaw.map((item) => item.string_list_data[0].value);

              // Baca file followers
              return readFileAsJson(followersFileInput.files[0]).then((followersData) => {
                // Ekstrak username dari data followers
                const followersRaw = Array.isArray(followersData) ? followersData : followersData.relationships_followers || [];
                const followers = followersRaw.map((item) => item.string_list_data[0].value);

                // Temukan yang tidak follow balik
                const notFollowingBack = following.filter((user) => !followers.includes(user));

                // Tampilkan hasil
                displayResults(notFollowingBack, following.length, followers.length);
              });
            })
            .catch((error) => {
              alert("Error: " + error.message);
              loader.style.display = "none";
            });
        }

        // Fungsi untuk membaca file JSON
        function readFileAsJson(file) {
          return new Promise((resolve, reject) => {
            const reader = new FileReader();

            reader.onload = (event) => {
              try {
                const data = JSON.parse(event.target.result);
                resolve(data);
              } catch (error) {
                reject(new Error("File JSON tidak valid"));
              }
            };

            reader.onerror = () => reject(new Error("Gagal membaca file"));
            reader.readAsText(file);
          });
        }

        // Fungsi untuk menampilkan hasil
        function displayResults(notFollowingBack, followingCount, followersCount) {
          loader.style.display = "none";

          countInfo.textContent = `Dari ${followingCount} following, terdapat ${notFollowingBack.length} orang yang tidak follow balik`;

          resultList.innerHTML = "";

          if (notFollowingBack.length > 0) {
            notFollowingBack.forEach((username, index) => {
              const div = document.createElement("div");
              div.className = "username";
              div.style.animationDelay = `${index * 0.05}s`;

              const link = document.createElement("a");
              link.href = `https://instagram.com/${username}`;
              link.target = "_blank";
              link.rel = "noopener noreferrer";
              link.textContent = username;
              link.style.color = "#c5bfff";
              link.style.textDecoration = "none";

              div.appendChild(link);
              resultList.appendChild(div);
            });
          } else {
            const div = document.createElement("div");
            div.className = "username";
            div.textContent = "Semua orang telah follow kamu balik! ✨";
            resultList.appendChild(div);
          }
          resultContainer.style.display = "block";
        }
      });
    </script>
  </body>
</html>
